<html>
  <head>
    <style>
      .cell {
        width: 100px;
        height: 100px;
        background-color: lightsteelblue;
        display: inline-block;
        border: 1px solid white;
        line-height: 100px;
        vertical-align: middle;
        text-align: center;
        font-size: 50px;
      }
    </style>
  </head>

  <body>
    <div id="board"></div>

    <script>
      // 1 = O, 2 = X
      const pattern = [
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
      ];

      const colorIcon = (color) => color === 2 ? '❌' : '⭕';

      function show() {
        const board = document.getElementById('board');
        board.innerHTML = '';

        for (let r = 0; r < 3; r++) {
          for (let c = 0; c < 3; c++) {
            const cell = document.createElement('div');
            cell.classList.add('cell');
            cell.innerText = pattern[r][c] === 2 ? '❌' : pattern[r][c] === 1 ? '⭕' : '';
            cell.addEventListener('click', () => move(c, r));
            board.appendChild(cell);
          }
          board.appendChild(document.createElement('br'));
        }
      }

      function check(pattern, color) {
        for (let r = 0; r < 3; r++) {
          let win = true;
          for (let c = 0; c < 3; c++) {
            if (pattern[r][c] !== color) {
              win = false;
              break;
            }
          }
          if (win)
            return true;
        }
        for (let c = 0; c < 3; c++) {
          let win = true;
          for (let r = 0; r < 3; r++) {
            if (pattern[r][c] !== color) {
              win = false;
              break;
            }
          }
          if (win)
            return true;
        }
        {
          let win = true;
          for (let r = 0; r < 3; r++) {
            if (pattern[r][r] !== color) {
              win = false;
              break;
            }
          }
          if (win)
            return true;
        }
        {
          let win = true;
          for (let r = 0; r < 3; r++) {
            if (pattern[r][2 - r] !== color) {
              win = false;
              break;
            }
          }
          if (win)
            return true;
        }
      }

      let color = 1;
      function move(c, r) {
        pattern[r][c] = color;
        if (check(pattern, color)) {
          alert(colorIcon(color) + ' has won!');
        }
        show();
        color = 3 - color;
        if (willWin(pattern, color)) {
          console.log(colorIcon(color) + 'will win');
        }
      }

      function clone(pattern) {
        return JSON.parse(JSON.stringify(pattern));
      }

      function willWin(pattern, color) {
        for (let r = 0; r < 3; r++) {
          for (let c = 0; c < 3; c++) {
            // 跳过有子位置
            if (pattern[r][c])
              continue;
            // 假设在此空白位置落子，判定是否胜利
            let supposedPattern = clone(pattern);
            supposedPattern[r][c] = color;
            if (check(supposedPattern, color)) {
              return true;
            }
          }
        }
        return false;
      }

      show();
    </script>
  </body>
</html>
